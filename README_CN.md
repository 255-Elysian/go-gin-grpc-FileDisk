# ğŸš€ gRPC åˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨ç³»ç»Ÿ

ä¸€ä¸ªåŸºäº Go çš„ä¼ä¸šçº§åˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨ç³»ç»Ÿï¼Œé›†æˆå¤‡å¿˜å½•ç®¡ç†å’Œäº‘å­˜å‚¨ç½‘ç›˜åŠŸèƒ½ã€‚

## âœ¨ ä¸»è¦ç‰¹æ€§

- ğŸ” **å®Œæ•´çš„ç”¨æˆ·ç³»ç»Ÿ** - æ³¨å†Œã€ç™»å½•ã€JWT è®¤è¯
- ğŸ“ **å¤‡å¿˜å½•ç®¡ç†** - ä»»åŠ¡åˆ›å»ºã€åˆ†ç±»ã€çŠ¶æ€ç®¡ç†
- ğŸ“ **å¤šç§ä¸Šä¼ æ–¹å¼** - è¡¨å•ä¸Šä¼ ã€æµå¼ä¸Šä¼ ã€å¼‚æ­¥ä¸Šä¼ 
- âš¡ **æ™ºèƒ½ç§’ä¼ ** - åŸºäº SHA256 çš„è·¨ç”¨æˆ·ç§’ä¼ 
- ğŸ” **å…¨ç›˜æœç´¢** - æ–‡ä»¶åæ¨¡ç³Šæœç´¢ï¼Œè·¨ç”¨æˆ·æ–‡ä»¶å‘ç°
- â˜ï¸ **ä¸ƒç‰›äº‘é›†æˆ** - å¯¹è±¡å­˜å‚¨ + CDN åŠ é€Ÿ
- ğŸ—ï¸ **å¾®æœåŠ¡æ¶æ„** - 4 ä¸ªç‹¬ç«‹æœåŠ¡æ¨¡å—
- ğŸ“Š **å¼‚æ­¥å¤„ç†** - Kafka æ¶ˆæ¯é˜Ÿåˆ—

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
Gateway (4000) â†â†’ User (10002)
       â†“              â†“
    Files (10004) â†â†’ Task (10003)
       â†“
   ä¸ƒç‰›äº‘å­˜å‚¨
```

**åŸºç¡€è®¾æ–½**: MySQL + Redis + Kafka + etcd

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡
- Go 1.19+
- Docker & Docker Compose

### 2. å¯åŠ¨åŸºç¡€æœåŠ¡
```bash
git clone <repository>
cd grpc-todolist-disk
docker-compose up -d
```

### 3. é…ç½®ä¸ƒç‰›äº‘
```bash
cp conf/config.example.yaml conf/config.yaml
# ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼Œå¡«å…¥ä¸ƒç‰›äº‘ä¿¡æ¯
```

### 4. å¯åŠ¨å¾®æœåŠ¡
```bash
# 4ä¸ªç»ˆç«¯åˆ†åˆ«å¯åŠ¨
go run app/user/cmd/main.go     # ç”¨æˆ·æœåŠ¡
go run app/task/cmd/main.go     # ä»»åŠ¡æœåŠ¡  
go run app/files/cmd/main.go    # æ–‡ä»¶æœåŠ¡
go run app/gateway/cmd/main.go  # ç½‘å…³æœåŠ¡
```

## ğŸ“– ä¸»è¦æ¥å£

### ç”¨æˆ·è®¤è¯
```bash
# æ³¨å†Œ
POST /api/v1/user/register
{"username": "test", "password": "123456"}

# ç™»å½•
POST /api/v1/user/login  
{"username": "test", "password": "123456"}
```

### æ–‡ä»¶æ“ä½œ
```bash
# ä¸Šä¼ æ–‡ä»¶
POST /api/v1/qiniu_file_upload
Content-Type: multipart/form-data

# æœç´¢æ–‡ä»¶
GET /api/v1/global_file_search?file_name=test

# ä¸‹è½½æ–‡ä»¶
GET /api/v1/qiniu_file_download?file_id=123

# åˆ é™¤æ–‡ä»¶
DELETE /api/v1/qiniu_file_delete
{"file_id": 123}
```

### å¤‡å¿˜å½•
```bash
# åˆ›å»ºä»»åŠ¡
POST /api/v1/task
{"title": "å­¦ä¹ Go", "content": "å®Œæˆé¡¹ç›®", "status": 0}

# è·å–ä»»åŠ¡åˆ—è¡¨
GET /api/v1/task?page=1&page_size=10
```

## ğŸ§ª æµ‹è¯•

```bash
cd test

# Go æµ‹è¯•ç¨‹åº
go run main.go                    # åŸºç¡€åŠŸèƒ½æµ‹è¯•
go run global_search_test.go      # æœç´¢æµ‹è¯•
go run qiniu_delete_test.go       # åˆ é™¤æµ‹è¯•

# Shell è„šæœ¬æµ‹è¯•
./simple_download_test.sh         # ä¸‹è½½æµ‹è¯•
./global_search_test.sh           # æœç´¢æµ‹è¯•
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
â”œâ”€â”€ app/                 # å¾®æœåŠ¡
â”‚   â”œâ”€â”€ gateway/        # APIç½‘å…³
â”‚   â”œâ”€â”€ user/           # ç”¨æˆ·æœåŠ¡
â”‚   â”œâ”€â”€ task/           # ä»»åŠ¡æœåŠ¡
â”‚   â””â”€â”€ files/          # æ–‡ä»¶æœåŠ¡
â”œâ”€â”€ conf/               # é…ç½®æ–‡ä»¶
â”œâ”€â”€ idl/                # Protoå®šä¹‰
â”œâ”€â”€ utils/              # å…¬å…±å·¥å…·
â”œâ”€â”€ test/               # æµ‹è¯•æ–‡ä»¶
â””â”€â”€ docker-compose.yml  # Dockerç¼–æ’
```

## ğŸ”§ æ ¸å¿ƒåŠŸèƒ½

### æ–‡ä»¶ä¸Šä¼ 
- **è¡¨å•ä¸Šä¼ **: å°æ–‡ä»¶ < 100MB
- **æµå¼ä¸Šä¼ **: å¤§æ–‡ä»¶åˆ†ç‰‡ä¸Šä¼ 
- **å¼‚æ­¥ä¸Šä¼ **: Kafka é˜Ÿåˆ—å¤„ç†
- **æ™ºèƒ½ç§’ä¼ **: SHA256 å“ˆå¸Œæ£€æµ‹

### å­˜å‚¨ç‰¹æ€§
- **è·¨ç”¨æˆ·å…±äº«**: ç›¸åŒæ–‡ä»¶åªå­˜ä¸€ä»½
- **å…¨ç›˜æœç´¢**: æ”¯æŒæ–‡ä»¶åæ¨¡ç³Šæœç´¢
- **å®‰å…¨åˆ é™¤**: æ™ºèƒ½åˆ¤æ–­æ˜¯å¦åˆ é™¤ç‰©ç†æ–‡ä»¶
- **äº‘å­˜å‚¨**: ä¸ƒç‰›äº‘ CDN åŠ é€Ÿè®¿é—®

## ğŸ› å¸¸è§é—®é¢˜

### æœåŠ¡å¯åŠ¨å¤±è´¥
```bash
# æ£€æŸ¥ç«¯å£å ç”¨
netstat -tulpn | grep :4000

# æ£€æŸ¥ä¾èµ–æœåŠ¡
docker-compose ps
```

### ä¸ƒç‰›äº‘é…ç½®
- ç¡®è®¤ AccessKey/SecretKey æ­£ç¡®
- æ£€æŸ¥å­˜å‚¨ç©ºé—´å’ŒåŸŸåé…ç½®
- éªŒè¯åŸŸåå¤‡æ¡ˆçŠ¶æ€

### æ•°æ®åº“é—®é¢˜
```bash
# æŸ¥çœ‹MySQLçŠ¶æ€
docker-compose logs mysql

# é‡å¯æ•°æ®åº“
docker-compose restart mysql
```

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

- **å¹¶å‘ç”¨æˆ·**: 1000+
- **æ–‡ä»¶å­˜å‚¨**: æ— é™åˆ¶ (ä¸ƒç‰›äº‘)
- **ä¸Šä¼ é€Ÿåº¦**: å–å†³äºç½‘ç»œå¸¦å®½
- **ç§’ä¼ å“åº”**: < 100ms

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ è®¸å¯è¯

MIT License

---

â­ è§‰å¾—æœ‰ç”¨è¯·ç»™ä¸ª Starï¼

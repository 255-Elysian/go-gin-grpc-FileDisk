## 计网

## 1.2因特网概述

网络（Network）：由若干结点（Node）和来连接这些结点的链路（Link）组成。

多个网络还可以通过路由器连起来，这样就构成了一个覆盖范围更大的网络，即互联网。因此，互联网是“网络的网络（Network of Network）。

因特网（Internet）是世界上最大的互连网络。

### 因特网发展的三个阶段

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241205112248_%E5%9B%A0%E7%89%B9%E7%BD%91%E5%8F%91%E5%B1%95.png)

### ISP

因特网服务提供者（Internet Service Provider）。

普通用户通过ISP接入因特网，ISP从因特网管理机构申请到成块的IP地址，同时拥有通信线路以及路由器等联网设备，任何机构和个人只要向ISP交纳规定的费用，就可以从ISP上得到所需要的IP地址。

我国的ISP机构主要是中国电信、中国移动和中国联通。

#### 基于ISP三层结构的因特网

- 第一层ISP通常也被称为因特网主干网，一般都能覆盖国际性区域范围，并拥有高速链路和交换设备。第一层ISP之间直接互联。
- 第二层ISP和一些大公司都是第一层ISP的用户，通常具有区域性或国家性覆盖规模，与少数第一层ISP相连接。
- 第三层ISP又称为本地ISP，是第二层ISP的用户，且只拥有本地范围的网络。一般的校园网或企业网，以及住宅用户和无线移动用户都是第三层ISP的用户。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241205113821_image.png)

### 因特网的标准化

特点：面向公众，所有的RFC（Request For Comments）技术文档都可以从因特网上免费下载。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241205114345_image.png)

只有一小部分RFC文档才能成为因特网标准。

### 因特网的组成

- 边缘部分：由所有连接在因特网上的主机组成。这部分是用户直接使用的，用来进行通信（传输数据、音频或视频）和资源共享。
- 核心部分：由大量网络和连接这些网络的路由器组成。这部分是为边缘部分提供服务的（提供连通性和交换）。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241205114800_image.png)

**路由器是实现分组交换的关键构件，其任务是转发收到的分组，这是网络核心部分最重要的功能。**

## 1.3三种交换方式

### 电路交换

在一个区域内，通过一台电话交换机将若干电话连接起来，不同区域之间通过链接若干电话交换机组成。

- 电话交换机接通电话线的方式称为电路交换（Circuit Switching）。
- 从通信资源的分配角度来看，交换（Switching）就是按照某种方式动态地分配传输线路的资源。

电路交换的三个步骤：

1. 建立链接（分配通信资源）
2. 通话（一直占用通信资源）
3. 释放连接（归还通信资源）

**当使用电路交换来传送计算机数据时，其线路的传输效率往往很低。**现在较少使用。

### 分组交换

- 发送方：构造分组，发送分组
- 路由器：缓存分组、转发分组
- 接收方：接受分组、还原报文

将报文分成一个个等长的数据块，并添加上首部，简称为“包”，首部可称为“包头”。

**现在基本都是使用分组交换。**

### 报文交换

与分组交换类似，但是其报文长度没有限制，这就要求交换结点需要有较大的缓存空间。现在较少使用。

### 总结

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241205121326_image.png)

## 1.4计算机网络的定义和分类

### 定义

- 计算机网络的精确定义并未统一
- 计算机网络的最简单定义是：一些互相连接的、自治的计算机的集合。

互联：是指计算机之间可以通过有线或无线的方式进行数据通信。

自治：是指独立的计算机，它有自己的硬件和软件，可以单独运行使用。

集合：是指至少需要两台计算机。

- 当前计算机网络的较好的定义是：计算机网络主要是由一些通用的、可编程的硬件互连而成的，而这些硬件并非专门用来实现某一特定目的（例如，传送数据或视频信号）。这些可编程的硬件能够用来传送多种不同类型的数据，并能支持广泛的和日益增长的应用。

### 分类

按交换技术分类：

- 电路交换网络
- 报文交换网络
- 分组交换网络

按使用者分类：

- 公用网
- 专用网

按传输介质分类：

- 有线网络
- 无线网络

按覆盖范围分类：

- 广域网WAN
- 域域网MAN
- 局域网LAN
- 个域网PAN

按拓扑结构分类：

- 总线型网络
- 星型网络
- 环型网络
- 网状型网络

## 1.5计算机网络的性能指标

可以从不同方面来度量计算机网络的性能。

指标：

- 速率：连接在计算机网络上的主机在数字信道上传送比特的速率，也被称为比特率或数据率。
- 带宽：用来表示网络的通信线路所能传送数据的能力，因此网络带宽表示在单位时间内从网络中的某一点到另一点所能通过的“最高数据率”。
- 吞吐量：表示在单位时间内通过某个网络（或信道、接口）的数据量。受网络的带宽或额定速率的限制。
- 时延：是指数据（一个报文或分组，甚至比特）从网络（或链路）的一端传送到另一端所需的时间。一般由发送时延、传播时延、处理时延和排队时延组成。
- 时延带宽积：传播时延 * 带宽。若发送端连续发送数据，则在发送的第一个比特即将到达终点时，发送端就已经发送了时延带宽积个比特。因此，链路的时延带宽积又称为以比特为单位的链路长度。
- 往返时间：RTT（Round-Trip Time）。
- 利用率：信道利用率指出某信道有百分之几的时间是被利用的（有数据通过）。网络利用率是指全网络的信道利用率的加权平均值。根据排队理论，当某信道的利用率增大时，该信道引起的时延也会迅速增加，因此，信道利用率并非越高越好。
- 丢包率：是指在一定时间范围内，传输过程中丢分的分组数量与总分组数量的比率。具体可分为接口丢包率、结点丢包率、链路丢包率、路径丢包率、网络丢包率等。

## 1.6计算机网络体系结构

### 常见的计算机网络体系结构

OSI体系结构（法律上的国际标准）：

- 应用层
- 表示层
- 会话层
- 运输层
- 网络层
- 数据链路层
- 物理层

TCP/IP体系结构（事实上的国际标准）：

- 应用层
- 运输层
- 网际层
- 网络接口层

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241206080606_image.png)

原理体系结构（适于教学）：

- 应用层
- 运输层
- 数据链路层
- 物理层

### 计算机网络体系结构分层的必要性

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241206081600_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241206081741_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241206081853_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241206081946_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241206082030_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241206082122_image.png)

### 术语

#### 实体

实体：任何可发送或接收信息的硬件或软件进程

对等实体：收发双方相同层次中的实体。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241206083130_image.png)

#### 协议

协议：控制两个对等实体进行逻辑通信的规则的集合。

逻辑通信表明实际上这种通信不存在，只是一种假设出来的通信。目的在于可以单独研究某一层结构时不用考虑其他层。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241206083505_image.png)

协议三要素：

- 语法：定义所交换信息的格式
- 语义：定义收发双方所要完成的操作
- 同步：定义收发双方的时序关系

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241206083747_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241206083955_image.png)

#### 服务

在协议的控制下，两个对等实体间的逻辑通信使得本层能够向上一层提供服务。

要实现本层协议，还需要使用下面一层所提供的服务。

协议是“水平的”，服务是“垂直的”。

实体看得见相邻下层所提供的服务，但并不知道实现该服务的具体协议。也就是说，下面的协议对上面的实体是“透明的”。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241206084449_image.png)

服务访问点：在同一系统中相邻两层的实体交换信息的逻辑接口，用于区分不同的服务类型。

- 数据链路层的服务访问点为帧的“类型”字段
- 网络层的服务访问点为IP数据报首部中的“协议字段”
- 运输层的服务访问点为“端口号”

服务原语：上层使用下层所提供的服务必须通过与下层交换一些命令，这些命令称为服务原语。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241206084905_image.png)

协议数据单元PDU：对等层次之间传送的数据包称为该层的协议数据单元。

服务数据单元SDU：同一系统内，层与层之间交换的数据包称为服务数据单元。

多个SDU可以合成为一个PDU；一个SDU也可划分为几个PDU。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241206085303_image.png)

## 2.1物理层的基本概念

传输媒体：

- 导引型：双绞线、同轴电缆、光纤、电力线等。
- 非导引型：微波通信（2~40GHz）、无线电波、红外线、看见过等。

物理层协议的主要任务：

- 机械特性：指明接口所用接线器的形状和尺寸、引脚数目和排列、固定和锁定装置。
- 电气特性：指明在接口电缆的各条线上出现的电压的范围。
- 功能特性：指明某条线上出现的某一电平的电压表示何种意义。
- 过程特性：指明对于不同功能的各种可能事件的出现顺序。

**重点：**

- **物理层考虑的是怎样才能在连接各种计算机的传输媒体上传输数据比特流。**
- **物理层为数据链路层屏蔽了各种传输媒体的差异，使数据链路层只需要考虑如何完成本层的协议和服务，而不必考虑网络具体的传输媒体是什么。**

## 2.3传输方式

串行传输和并行传输：

- 串行传输是指数据是一个比特一个比特依次发送的。收发端之间只需要一条传输线。
- 并行传输是指一次发送n个比特。收发端之间需要有n条传输线。（常用）

**同步传输和异步传输：**

- **同步传输是指数据块以稳定的比特流的形式传输，字节之间没有间隔。接收端在每个比特信号的中间时刻进行检测，以判别接收到的是比特0还是比特1。（收发双方时钟要保持同步）**
- **异步传输是指以字节为独立的传输单位，字节之间的时间间隔不是固定的，接收端仅在每个字节的起始处对字节内的比特实现同步。（要在每个字节前后分别加上起始位和结束位）**
- **异步是指字节之间异步（字节之间的时间间隔不固定），但字节中的每个比特仍然要同步（各比特的持续时间是相同的）**

单工、半双工和全双工：

- 单工，即单工通信，又称单向通信，通信双方只有一个数据传输方向。（如无线电广播）
- 半双工，即半双工通信，又称双向交替通信，通信双方可以互相通信，但不能同时进行。（如对讲机）
- 全双工，即全双工通信，又称双向同时通信，通信双方可以同时发送和接受信息。（如电话）

## 2.4编码与调制

码元：在使用时间域的波形表示数字信号时，代表不同离散数值的基本波形。简而言之，码元就是构成信号的一段波形，可以表示任意数字信号。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241207123344_image.png)

### 编码

不归零编码：在整个码元时间内，电平不会出现零电平。（存在同步问题，一般不使用）

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241207124712_image.png)

归零编码：每个码元传输结束之后信号都要“归零”。（自同步，但编码效率低）

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241207125017_image.png)

曼彻斯特编码、差分曼彻斯特编码：差分曼彻斯特编码比曼彻斯特编码变化少，更适合较高的传输速率。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241207125254_image.png)

### 调制

基本调制方法：一个码元只能包含一个比特信息。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241207125725_image.png)

混合调制：

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241207125918_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241207125959_image.png)

QAM-16：

- 可以调制出16种码元（波形），每种码元可以对应表示4个比特。
- 码元与4个比特的对应关系采用格雷码，即任意两个相邻码元只有1个比特不同。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241207130138_image.png)

## 2.5信道极限容量

码间串扰：信号波形失去了码元之间的清晰界限。

产生原因：码元传输速率、信号传输距离、噪声干扰、传输媒体质量。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241207131212_image.png)

奈氏准则：在假定的理想条件下，为了避免码间串扰，码元传输速率是有上限的。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241207131502_image.png)

香农公式：带宽受限且有高斯白噪声干扰的信道的极限信息传输速率。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241207131637_image.png)

- 在信道带宽一定的情况下，根据奈氏准则和香农公式，要想提高信息的传输速率就必须采用多元制（更好的调制方法）和努力提高信道中的信噪比。
- 自从香农公式发表后，各种新的信号处理和调制方法就不断出现，其目的都是为了尽可能地接近香农公式给出的传输速率极限。

## 3.1数据链路层概述

链路(Link)：就是一个结点到相邻结点的一段物理线路，而中间没有任何其他的交换结点。

数据链路(Data Link)：是指把实现通信协议的硬件和软件加到链路上，就构成了数据链路。

数据链路层以帧为单位传输和处理数据。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241227070518_image.png)

### 三个重要问题

#### 封装成帧

将数据链路层给网络层交付的协议数据单元添加帧头和帧尾的操作，称为封装成帧。其目的是为了在链路上以帧为单元来传送数据，也就是为了实现数据链路层本身的功能。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241227071006_image.png)

#### 差错检测

帧在传输过程中遭遇干扰后可能会出现误码，也就是比特0可能变成了比特1，反之亦然。

基于待发送的数据和检错算法计算出检错码，将其封装在帧尾。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241227071353_image.png)

#### 可靠传输

尽管误码是不能完全避免的，但若能实现发送方发送什么，接收方就能受到什么，就称为可靠传输。

## 3.2封装成帧

### 帧定界

帧头和帧尾的作用之一就是帧定界。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241227072830_image.png)

但并不是每一种数据链路层都有帧定界，如以太网V2的MAC帧。它会在物理层添加前导码，且规定帧间间隔（96比特时间）。因此MAC帧不需要帧结束定界符。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241227073023_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241227073321_image.png)

### 透明传输

透明传输是指数据链路层对上层交付的传输数据没有任何限制，就好像数据链路层不存在一样。

即通过在帧的数据部分插入特殊字符来保证帧定界的唯一性。

- 面向字节的物理链路使用字节填充（或称字符填充）的方法实现透明传输。
- 面向比特的物理链路使用比特填充的方法实现透明传输。

在数据发送前对帧进行扫描，若在发送内容里面扫描到了帧定界符和转义字符，就在其前面添加转义字符，避免接收方没有收到完整的数据。

**转义字符是一种特殊的控制字符，其长度为一个字节，十进制值为27，并非E、S、C这三个字符。**

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241227074058_image.png)

- 为了提高帧的传输效率，应当使帧的数据部分的长度尽可能大些。
- 考虑到差错控制等多种因素，每一种数据链路层协议都规定了帧的数据部分的长度上限，即最大传送单元MTU(Maximum Transfer Unit)。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241227074617_image.png)

### 差错检测

比特在传输过程中可能会产生差错：1可能变成0，0可能变成1.这成为比特差错。

在一段时间内，传输错误的比特占所传输比特总数的比率称为误码率BER(Bit Error Rate)。

使用差错检测码来检测数据在传输过程中是否产生了比特差错，是数据链路层所要解决的重要问题之一。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241227075121_image.png)

#### 奇偶校验

在待发送的数据后面添加1位奇偶校验位，是整个数据（包括所添加的校验位在内）中"1"的个数为奇数（奇校验）或偶数（偶校验）。

- 如果有奇数个位发生误码，则奇偶性发生变化，可以检查出误码
- 如果有偶数个位发生误码，则奇偶性不发生变化，不能检查出误码（漏检）

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241227075429_image.png)

#### 循环冗余校验CRC(Cyclic Redundancy Check)

- 收发双方约好一个生成多项式G(x)
- 发送方基于待发送的数据和生成多项式计算出差错检测码（冗余码），将其添加到待传输数据的后面一起传输
- 接收方通过生成多项式来计算收到的数据是否产生了误码

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241227080037_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241227080149_image.png)

举例：

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241227080418_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_241227080529_image.png)

**说明：**

- **检错码只能检测出帧在传输过程中出现了差错，但并不能定位错误，因此无法纠正错误。**
- **要想纠正传输中的差错，可以使用冗余信息更多的纠错码进行前向纠错。但纠错码的开销比较大，在计算机网络中较少使用。**
- **循环冗余校验CRC有很好的检错能力（漏检率非常低），虽然计算比较复杂，但非常易于用硬件实现，因此被广泛应用于数据链路层。**
- **在计算机网络中通常采用检错重传方式来纠正传输中的差错，或者仅仅是丢弃检测到差错的帧，这取决于数据链路层向其上层提供的是可靠传输服务还是不可靠传输服务。**

## 3.4可靠传输

### 3.4.1概念

数据链路层向上层提供服务类型：

- 不可靠传输服务：仅仅丢弃有误码的帧，其他什么也不做
- 可靠传输服务：想办法实现发送端发送什么，接收端就收到什么

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250101163705_image.png)

从整个计算机网络体系结构来看，传输差错包括：比特差错、分组丢失、分组失序以及分组重复。

- 比特差错：即误码。
- 分组丢失：例如，主机发送的信息到达路由器，但路由器输入队列快满了，主动丢弃收到的分组。
- 分组失序：最先发送的分组未必最先到达。
- 分组重复：发送的分组在网络中滞留了，导致发送方对该分组超时重发，最终有两个相同分组到达接收方。

分组丢失、分组失序和分组重复一般不会出现在数据链路层，而会出现在其上层。

可靠传输服务并不仅局限于数据链路层，其他各层均可选择实现可靠传输。

例：TCP/IP的四层体系结构

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250101164645_image.png)

### 3.4.2实现机制

实现机制的基本原理并不仅限于数据链路层，可以应用到计算机网络体系结构的各层协议中。

#### 停止-等待协议SW

确认分组：ACK

否认分组：NAK

发送方每发完一个数据分组后，并不能立刻将该数据分组从缓存中删除，只有在收到针对该数据分组的确认分组后，才能将其从缓存中删除。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250103035140_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250103035747_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250103040030_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250103040214_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250103040347_image.png)

- Ta一般远小于Td，可以忽略。
- 当RTT远大于Td时，信道利用率会非常低。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250103040922_image.png)

发送方在收到接收方的确认分组之前，可以连续发送多个数据分组，这就大大提升了信道利用率。

#### 回退N帧协议GBN

在流水线传输的基础上，利用发送窗口来限制发送方可连续发送数据分组的个数，是一种连续ARQ协议。

在协议的工作过程中发送窗口和接收窗口不断向前滑动，因此这类协议又称为滑动窗口协议。

由于回退N帧协议的特性，当通信线路质量不好时，其信道利用率并不比停止-等待协议高。

举个例子：

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250103041449_image.png)

累积确认：接收方不一定要对收到的数据分组逐个发送确认，而是可以在收到几个数据分组后（由具体实现决定），**对按序达到的最后一个数据分组发送确认**。ACKn表示序号为n及以前的所有数据分组都已正确接收。

- 即使确认分组丢失，发送方也可能不必重传
- 可以减小接收方的开销
- 减少对网络资源的占用
- 不能向发送方及时反映出接收方已经正确接收的数据分组信息

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250103042937_image.png)

#### 选择重传协议SR

- 回退N帧协议的接收窗口尺寸Wr只能等于1，因此接收方只能按序接收正确达到的数据分组。
- 一个数据分组的误码就会导致其后续多个数据分组不能被接收方按序接收而丢弃（尽管他们无乱序和误码）。这必然会造成发送方对这些数据分组的超时重传，显然这是对通信资源的极大浪费。
- 为了进一步提高性能，可设法只重传出现误码的数据分组。因此，接收窗口的尺寸Wr不应再等同于1（而应大于1），以便接收方先收下失序到达但无误码并且序号落在接收窗口内的那些数据分组，等到所缺失分组收齐后再一并送交上层。这就是选择重传协议。
- 注意：选择重传协议为了使发送方仅重传出现差错的分组，接收方不能再采用累积确认，而需要对每个正确收到的数据分组进行逐一确认。

## 3.5点对点协议PPP

（Point-to-Point Protocol）是目前使用最广泛的点对点数据链路层协议。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250103112345_image.png)

![o_250103112345_image](C:\Users\elisia\Desktop\o_250103112345_image.png)

PPP协议为在点对点链路传输各种协议数据报提供了一个标准方法，主要由以下三部分构成：

- 对各种协议数据报的封装方法（封装成帧）
- 链路控制协议LCP（用于建立、配置以及测试数据链路的链接）
- 一套网络控制协议NCPs（其中的每一个协议支持不同的网络层协议）

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250103113350_image.png)

帧格式：

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250103113638_image.png)

透明传输：

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250103113821_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250103114028_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250103114152_image.png)

差错检测：

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250103114353_image.png)

工作状态：

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250103115416_image.png)

## 3.6.1媒体接入控制

MAC（Medium Access Control），共享信道要着重考虑的一个问题就是如何协调多个发送和接受站点对一个共享传输媒体的占用。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250103120155_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250103120423_image.png)

注意：随着技术的发展，交换技术的成熟和成本的降低，具有更高性能的使用点对点链路和链路层交换机的交换式局域网在有线领域已完全取代了共享式局域网，但由于无线信道的广播天性，无线局域网仍然使用的是共享媒体技术。

### 静态划分信道

信道复用：

- 复用是通信技术中的一个重要概念。复用就是通过一条物理线路同时传输多路用户的信号。
- 当网络中传输媒体的传输容量大于多条单一信道传输的总通信量时，可利用复用技术在一条物理线路上建立多条通信信道来充分利用传输媒体的带宽。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250104043422_image.png)

#### 频分复用FDM

将传输信号资源划分为多个子频带，形成多个子信道，子信道之间需要留出隔离频带，以免造成子信道间的干扰。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250104043826_image.png)

#### 时分复用TDM

划分时隙，每对用户只在所分配的时隙里使用线路传输数据。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250104044042_image.png)

#### 波分复用WDM

掺铒光纤放大器是用来将衰减的光信号重新放大。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250104044400_image.png)

#### 码分复用CDM

- 码分复用CDM是另一种共享信道的方法。实际上，由于该技术主要用于多址接入，人们更常用的名词是码分多址CDMA（Code Division Multiple Access）。
- 同理，频分复用FDM和时分复用TDM同样可用于多址接入，相应的名词是频分多址FDMA（Frequency Division Multiple Access）和时分多址TDMA（Time Division Multiple Access）。
- 某种程度上，FDMA、TDMA、CDMA可以分别看成是FDM、TDM、CDM的应用。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250104044826_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250104061220_image.png)

### 动态接入控制-随机接入

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250104063216_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250104063458_image.png)

#### CSMA/CD协议（总线局域网使用）

##### 争用期（碰撞窗口）

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250104063807_image.png)

##### 最小帧长

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250104064003_image.png)

##### 最大帧长

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250104064121_image.png)

##### 截断二进制指数退避算法

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250104064648_image.png)

##### 信道利用率

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250104064852_image.png)

##### 帧发送流程

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250104065445_image.png)

#### CSMA/CA协议（无线局域网使用）

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250104065914_image.png)

![o_250104065914_image](C:\Users\elisia\Desktop\o_250104065914_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250104070221_image.png)

##### 帧间间隔IFS

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250104070317_image.png)

##### 工作原理

1、源站为什么在检测到信道空闲后还要再等待一段时间DIFS？

就是考虑到可能有其他的站有高优先级的帧要发送。若有，就要让高优先级帧发送。

2、目的站为什么正确接收数据帧后还要等待一段时间SIFS才能发送ACK帧？

SIFS是最短的帧间间隔，用来分隔开属于一次对话的各帧。在这段时间内，一个站点应当能够从发送方式切换到接收方式。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250104070959_image.png)

##### 退避算法

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250104071127_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250104071812_image.png)

##### 信道预约

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250104071951_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250104072100_image.png)

##### 虚拟载波监听

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250104072214_image.png)

## 3.7MAC地址、IP地址以及APP地址

- MAC地址是以太网的MAC子层所使用的地址。
- IP地址是TCP/IP体系结构网际层所使用的地址。
- ARP协议属于TCP/IP体系结构的网际层，其作用是已知设备所分配到的IP地址，使用ARP协议可以通过该IP地址获取到设备的MAC地址。
- 从网络体系结构的角度，MAC地址属于数据链路层，IP地址和ARP协议属于网际层。

### MAC地址

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250105125543_image.png)

- 当多个主机连接在同一个广播信道上，要想实现两个主机之间的通信，则每个主机都必须有一个唯一的标识，即一个数据链路层地址。
- 在每个主机发送的帧中必须携带标识发送主机和接收主机的地址。由于这类地址是用于媒体接入控制MAC（Media Access Control），因此这类地址被称为MAC地址。
- MAC地址一般被固化在网卡（网络配适器）的电可擦可编程只读存储器EEPROM中，因此MAC地址也被称为硬件地址。
- MAC地址有时也被称为物理地址。**请注意：这并不意味着MAC地址属于网络体系结构中的物理层！**
- 一般情况下，用户主机会包含两个网络配适器：有线局域网配适器（有线网卡）和无线局域网配适器（无线网卡）。每个网络配适器都有一个全球唯一的MAC地址。而交换机和路由器往往拥有更多的网络接口，所以会拥有更多的MAC地址。综上所述，**严格来说，MAC地址是对网络上各接口的唯一标识，而不是对网络上各设备的唯一标识。**

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250105125757_image.png)

IEEE 802局域网的MAC地址格式：

八个比特为一个字节

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250105131404_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250105132214_image.png)

字节发送顺序：第一字节 ——> 第六字节

字节内的比特发送顺序：b0 ——> b7

### IP地址

IP地址是因特网上的主机和路由器所使用的地址，用于标识两部分信息：

- 网络编号：标识因特网上数以百万计的网络
- 主机编号：标识同一网络上 不同主机（或路由各接口）

很显然，之前介绍的MAC地址不具备区分不同网络的功能。

- 如果只是一个单独的网络，不接入因特网，可以只使用MAC地址（这不是一般用户的应用方式）。
- 如果主机所在的网络要接入因特网，则IP地址和MAC地址都需要使用。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250105134854_image.png)

IP地址与MAC地址的区别：

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250105135200_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250105135541_image.png)

### ARP协议

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250105140029_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250105140349_image.png)

不能跨网络使用：

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250105140746_image.png)

## 3.8集线器与交换机的区别

### 集线器

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250106132845_image.png)

使用集线器HUB在物理层扩展以太网：

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250106133003_image.png)

- 一系中，主机发送的信号会通过HUB发送给其他主机。
- 二系中，两台主机同时发送信号进行碰撞，其碰撞信号也会发送给其他主机。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250106133250_image.png)

### 以太网交换机

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250106133428_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250106133648_image.png)![o_250106133648_image](C:\Users\elisia\Desktop\o_250106133648_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250106133951_image.png)

### 总结

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250106134357_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250106134454_image.png)

## 3.9以太网交换机自学习和转发帧的流程

- 以太网交换机工作在数据链路层（也包括物理层）。
- 以太网交换机收到帧后，在帧交换表中查找帧的目的MAC地址所对应的接口号，然后通过该接口转发帧。
- 以太网交换机是一种即插即用设备，刚上电启动时其内部的帧交换表是空的。随着网络中各主机间的通信，以太网交换机通过自学习算法自动逐渐建立起帧交换表。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250106135702_image.png)

## 3.10以太网交换机生成树协议STP

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250106140124_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250106140620_image.png)

## 3.11虚拟局域网VLAN

### 概述

虚拟局域网VLAN（Virtual Local Area Network）是一种将局域网内的设备划分成与物理位置无关的逻辑组的技术，这些逻辑组具有某些共同的需求。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250106141011_image.png)

### 实现机制

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250106141228_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250106141401_image.png)

Access：

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250106141652_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250106141833_image.png)

Trunk：

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250106142258_image.png)

Hybrid：

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250106143200_image.png)

## 4.1网络层概述

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250107131609_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250107131802_image.png)

## 4.2网络层提供的两种服务

### 面向链接的虚电路服务

虚电路只是一条逻辑电路，实际上并不存在。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250107132217_image.png)

### 无连接的数据报服务

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250107132523_image.png)

### 区别

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250107132735_image.png)

## 4.3IPv4地址

### 概述

在TCP/IP体系中，IP地址是一个最基本的概念。

IPv4地址就是因特网（Internet）上的每一台主机（或路由器）的每一个接口分配一个在全世界范围内是唯一的32比特的标识符。

IP地址由因特网名字和数字分配机构ICANN（Internet Corporation Assigned Names and Numbers）进行分配。

- 我国用户可向亚太网络信息中心APNIC（Asia Pacific Network Information Center）申请IP地址，需要缴费。
- 2011年2月3日，互联网号码分配管理局IANA（由ICANN行使职能）宣布，IPv4地址已经分配完毕。
- 我国在2014至2015年也逐步停止了向新用户和应用分配IPv4地址。同时全面展开商用部署IPv6。

IPv4地址的编址方法经历了如下三个历史阶段：

- 1981——分类编址
- 1985——划分子网
- 1993——无分类编址

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250108145004_image.png)

**IPv4地址中，每8位为一组。**

### 分类编址的IPv4地址

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250109122750_image.png)

A类地址：

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250109123146_image.png)

B类地址：

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250109123426_image.png)

C类地址：

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250109123851_image.png)

### 划分子网的IPv4地址

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250109124458_image.png)

举例：

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250109124935_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250109125255_image.png)

默认的子网掩码：

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250109125459_image.png)

### 无分类编址的IPv4地址

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250109125628_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250109125802_image.png)

举例：

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250109131445_image.png)

CIDR中路由聚合（构造超网）：

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250109132932_image.png)

### IPv4地址的应用规划

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250109134142_image.png)

定长的子网掩码FLSM：

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250109134609_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250109135327_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250109135653_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250109135745_image.png)

变长的子网掩码VLSM：

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250109135903_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250109140003_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250109140243_image.png)

## 4.4IP数据报的发送和转发过程

包含两部分：主机发送IP数据报、路由器转发IP数据报

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250111043453_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250111045148_image.png)

## 4.5静态路由配置及其可能产生的路由环路问题

静态路由配置是指用户或网络管理员使用路由器的相关命令给路由器人工配置路由表。

- 这种人工配置方式简单、开销小。但不能及时适应网络状态（流量、拓扑等）的变化。
- 一般只在小规模网络中采用。

使用静态路由配置可能出现以下导致产生路由环路的错误：

- 配置错误
- 聚合了不存在的网络
- 网络故障

静态路由配置：

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250111050411_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250111050500_image.png)

默认路由：

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250111050732_image.png)

特定主机：

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250111050859_image.png)

黑洞路由：下一跳为**null0**。

## 4.6路由选择协议

### 概述

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250111052142_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250111052405_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250111062626_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250111062750_image.png)

**文档名称，并非具体协议。**

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250111063650_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250111063810_image.png)

### 路由信息协议RIP的基本工作原理

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250111073952_image.png)

PIR认为好的路由就是“距离短”的路由，也就是所通过路由器数量最少的路由。

当到达同一目的网络有多条“距离相等”的路由时，可以进行等价负载均衡。

RIP包含以下三个要点：

- 和谁交换信息——仅和相邻路由器交换信息
- 交换什么信息——自己的路由表
- 何时交换信息——周期性交换（例如每30秒）

RIP的基本工作过程：

1. 路由器刚开始工作时，只知道自己到直连网络的距离为1。
2. 每个路由器仅和相邻路由器周期性地交换并更新路由信息。
3. 若干次交换和更新后，每个路由器都知道到达本AS内各网络的最短距离和下一跳地址，称为收敛。

RIP的路由条目的更新规则：

- 发现了新的网络，添加
- 到达目的网络，不同下一跳，新路由优势，更新
- 到达目的网络，不同下一跳，等价负载均衡
- 到达目的网络，相同下一跳，最新消息，更新
- 到达目的网络，不同下一跳，新路由劣势，不更新

RIP存在“坏消息传播得慢”的问题。

“坏消息传播得慢”又称为路由环路或距离无穷计数问题，这是距离向量算法的一个固有问题。可以采取多种措施减少出现该问题的概率或减小该问题带来的危害。

- 限制最大路径距离为15（16表示不可达）
- 当路由表发生变化时就立刻发送更新报文（即“触发更新”），而不是周期性发送
- 让路由器记录收到某特定路由信息的接口，而不让同一路由信息再通过此接口向反方向传送（即“水平分割”）

### 开放最短路径优先OSPF的基本工作原理

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250112111925_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250112112056_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250112112253_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250112112402_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250112112548_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250112112844_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250112112959_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250112113532_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250112114032_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250112114330_image.png)

### 边界网关协议BGP的基本工作原理

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250112114805_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250112115116_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250112115237_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250112115349_image.png)

## 4.7IPv4数据报的首部格式

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250113054906_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250113060743_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250113062803_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250113063048_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250113064928_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250113064933_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250113065201_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250113070444_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250113072810_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250113073115_image.png)

## 4.8网际控制报文协议ICMP

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250113074855_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250113075018_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250113080605_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250113080724_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250113080843_image.png)

以下情况不应发送ICMP差错报告报文：

- 对ICMP差错报告报文不再发送ICMP差错报告报文
- 对第一个分片的数据报片的所有后续数据报片都不发送ICMP差错报告报文
- 对具有多播地址的数据报都不发送ICMP差错报告报文
- 对具有特殊地址（如127.0.0.0或0.0.0.0）的数据报不发送ICMP差错报告报文

常用的ICMP询问报文有两种：

- 回送请求和回答：ICMP回送请求报文是由主机或路由器向一个特定的目的主机发出的询问。收到此报文的主机必须给源主机或路由器发送ICMP回送回答报文。这种询问报文用来测试目的站是否可达及了解其有关状态。
- 时间戳请求和回答：ICMP时间戳请求报文是请某个主机或路由器回答当前的日期和时间。在ICMP时间戳回答报文中有一个32位的字段，其中写入的整数代表从1900年1月1日起到当前时刻一共有多少秒。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250113104138_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250113110023_image.png)

## 4.8虚拟专用网VPN与网络地址转换NAT

### 虚拟专用网VPN（Virtual Private Network）

利用公用的因特网作为本机构各专用网之间的通信载体，这样的专用网又称为虚拟专用网。由于IPv4地址的紧缺，一个机构能够申请到的IPv4地址数量往往远小于本机构所拥有的主机数量。因此，虚拟专用网中的各主机所分配的地址应该是本机构可自由分配的专用地址，而不是需要申请的、在因特网上使用的共有地址。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250113114002_image.png)

### 网络地址转换NAT（Network Address Translation）

由于绝大多数的网络应用都是使用运输层协议TCP或UDP来传输数据，因此可以利用运输层的端口号和IP地址一起进行转换。

这样，用一个全球IP地址就可以使多个拥有本地地址的主机同时和因特网上的主机进行通信。这种将端口号和IP地址一起进行转换的技术叫作网络地址与端口号转换NAPT（Network Address and Port Translation）。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250113124443_image.png)

另外，对于NAT对外网屏蔽了内网主机的网络地址，能为内网主机提供一定的安全保护。

## 5.1运输层概述

运输层直接为应用进程间的逻辑通信提供服务。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250113130637_image.png)

## 5.2运输层端口号、复用与分用的概念

运行在计算机上的进程使用进程标识符PID来标志。

因特网上的计算机并不是使用统一的操作系统，不同的操作系统又使用不同格式的进程标识符。

为了使运行不同操作系统的计算机的应用进程之间能够进行网络通信，就必须使用统一的方法对TCP/IP体系的应用进程进行标识。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250114061913_image.png)

端口号只具有本地意义，即端口号只是为了标识本计算机应用层中的各进程，在因特网中，不同计算机中的相同端口号是没有联系的。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250114062211_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250114070959_image.png)

## 5.3UDP和TCP的对比

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250114074557_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250114080054_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250114081205_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250114081614_image.png)

总结：

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250114081748_image.png)

## 5.4TCP的流量控制

一般来说，我们总是希望数据传输得更快一些，但如果发送方把数据发送得过快，接收方就可能来不及接收，这就会造成数据的丢失。

所谓流量控制（flow control）就是让接收方的发送速率不要太快，要让接收方来得及接收。

利用滑动窗口机制可以很方便地在TCP链接上实现发送方的流量控制。

- TCP接收方利用自己的接收窗口的大小来限制发送方发送窗口的大小。
- TCP发送方收到接收方的零窗口通知后，应启动持续计时器。持续计时器超时后，向接收方发送零窗口探测报文。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250114090646_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250114092430_image.png)

## 5.5TCP的拥塞控制

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250115064633_image.png)

四种算法的基本原理，假定如下条件：

- 数据是单方向传送，而另一个方向只传送确认
- 接收方总是有足够大的缓存空间，因而发送方发送窗口的大小由网络的拥塞程度来决定
- 以最大报文段MSS的个数为讨论问题的单位，而不是以字节为单位

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250115065053_image.png)

### 慢开始

拥塞窗口值是几，就能发送几个数据报文段。发送方每收到一个对新报文段的确认时，就把拥塞窗口值按指数规律增加。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250115065406_image.png)

### 拥塞避免

每个传输轮次结束后，拥塞窗口值只能线性加一。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250115070029_image.png)

### 小结

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250115070218_image.png)

慢开始和拥塞避免算法是1988年提出的TCP拥塞控制算法（TCP Tahoe版本）。

1990年又增加了两个新的拥塞控制算法（改进TCP的性能），这就是快重传和快恢复（TCP Reno版本）。

有时，个别报文段会在网络中丢失，但实际上网络并未发生拥塞。

- 这将导致发送方超时重传，并误认为网络发生了拥塞
- 发送方把拥塞窗口cwnd又设置为最小值1，并错误地启动了慢开始算法，因而降低了传输效率

### 快重传

采用快重传算法可以让发送方尽早知道发生了个别报文段的丢失。

所谓快重传，就是使发送方尽快进行重传，而不是等超时重传计时器超时再重传。

- 要求接收方不要等待自己发送数据时才进行捎带确认，而是要立即发送确认
- 即使收到了失序的报文段也要立即发出对已收到的报文段的重复确认
- 发送方一旦收到3个连续的重复确认，就将相应的报文段立即重传，而不是等该报文段的超时重传计时器超时再重传
- 对于个别丢失的报文段，发送方不会出现超时重传，也就不会误认为出现了拥塞（进而降低拥塞窗口cwnd为1）。使用快重传可以使整个网络的吞吐量提高约20%

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250115071846_image.png)

### 快恢复

发送方一旦收到3个重复确认，就知道现在只是丢失了个别的报文段。于是不启动慢开始算法，而执行快恢复算法。

发送方将慢开始门限ssthresh值和拥塞窗口cwnd值调整为当前窗口的一半，开始执行拥塞避免算法。

也有的快恢复实现是把快恢复开始时的拥塞窗口cwnd值再增大一些，即等于新的ssthresh + 3。

- 既然发送方收到3个重复确认，就表明有3个数据报文段已经离开了网络
- 这3个报文段不再消耗网络资源而是停留在接收方的接收缓存中
- 可见现在网络中不是堆积了报文段而是减少了3个报文段。因此可以适当把拥塞窗口扩大些

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250115072547_image.png)

## 5.6TCP超时重传时间的选择

超时重传时间的选择是TCP最复杂的问题之一。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250115073007_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250115073139_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250115073438_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250115073548_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250115073758_image.png)

## 5.7TCP可靠传输的实现

TCP基于以字节为单位的滑动窗口来实现可靠传输。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250115074207_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250115074356_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250115074835_image.png)

虽然发送方的发送窗口是根据接收方的接收窗口设置的，但在同一时刻，发送方的发送窗口并不总是和接收方的接收窗口一样大。

- 网络传送窗口值需要经历一定的时间滞后，并且这个时间还是不确定的。
- 发送方还可能根据网络当时的拥塞情况适当减小自己的发送窗口尺寸。

对于不按序列到达的数据应如何处理，TCP并无明确规定。

- 如果接收方把不按序列到达的数据一律丢弃，那么接收窗口的管理将会比较简单，但这样做对网络资源的利用不利，因为发送方会重复传送比较多的数据。
- TCP通常对不按序列到达的数据是先临时存放在接收窗口中，等到字节流中所缺少的字节收到后，再按序交付上层的应用进程。

TCP要求接收方必须有累计确认和捎带确认机制，这样可以减小传输开销。接收方可以在合适的时候发送确认，也可以在自己有数据要发送时把确认消息顺便捎带上。

- 接收方不应过分推迟发送确认，否则会导致发送方不必要的超时重传，这反而浪费了网络的资源。
- TCP明文规定，确认推迟的时间不应超过0.5秒。若收到一连串具有最大长度的报文段，则必须每隔一个报文段就发送一个确认[RFC 1122]。
- 捎带确认实际上并不经常发生，因为大多数应用程序很少同时在两个方向上发送数据。

TCP的通信是全双工通信。通信中的每一方都在发送和接收报文段。因此，每一方都有自己的发送窗口和接收窗口。在谈到这些窗口时，一定要弄清楚是哪一方的窗口。

## 5.8TCP的运输连接管理

### TCP的连接建立

TCP是面向连接的协议，它基于运输连接来传送TCP报文段。

TCP运输连接的建立和释放是每一次面向连接的通信中必不可少的过程。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116082656_image.png)

TCP连接建立要解决以下三个问题：

- 使TCP双方能够确知对方的存在。
- 使TCP双方能够协商一些参数（如最大窗口值、是否使用窗口扩大选项和时间戳选项以及服务质量等）。
- 使TCP双方能够对运输实体资源（如缓存大小、连接表中的项目等）进行分配。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116084140_image.png)

注意：

- TCP的标准规定，SYN=1的报文段不能携带数据，但要消耗一个序号。
- TCP的标准规定，普通的确认报文段如果不携带数据，则不消耗序号。

### TCP的连接释放

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116085247_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116085554_image.png)

## 5.9TCP报文段的首部格式

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116085719_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116090140_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116090226_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116090441_image.png)

确认标志位ACK：取值为1时确认号字段才有效；取值为0时确认号字段无效。

TCP规定，在连接建立后所有传送的TCP报文段都必须把ACK置1。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116090837_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116090928_image.png)

20字节 = 5 * 4字节			60字节 = 15 * 4字节

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116091208_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116091242_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116091314_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116091526_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116091701_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116091749_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116091821_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116091857_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116092050_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116092127_image.png)

## 6.1应用层概述

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116092246_image.png)

应用层是计算机网络体系结构的最顶层，是设计和建立计算机网络的最终目的，也是计算机网络中发展最快的部分。

- 早期基于文本的应用（电子邮件、远程登录、文件传输、新闻组）。
- 20世纪90年代将因特网带入千家万户的万维网WWW。
- 当今流行的即时通信、P2P文件共享及各种音视频应用。
- 计算设备的小型化和“无处不在”，宽带住宅接入和无线接入的日益普及和迅速发展，为未来更多的新型应用提供了广阔的舞台。

## 6.2客户/服务器方式（C/S方式）和对等方式（P2P）

网络应用程序运行在处于网络边缘的不同端系统上，通过彼此间的通信来共同完成某项任务。

开发一种新的网络应用首先要考虑的问题就是网络应用程序在各端系统上的组织方式和它们之间的关系。目前流行的主要有以下两种：

- 客户/服务器（Client/Server，C/S）方式
- 对等（Peer-to-Peer，P2P）方式

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116093145_image.png)

C/S方式是因特网上传统的、同时也是最成熟的方式，很多我们熟悉的网络应用采用的都是C/S方式。包括万维网WWW、电子邮件、文件传输FTP等。

基于C/S方式的应用服务通常都是服务集中型的，即应用服务集中在网络中比客户计算机少得多的服务器计算机上。

- 由于一台服务器计算机要为多个客户机提供服务，在C/S应用中，常会出现服务器计算机跟不上众多客户机请求的情况。
- 为此，在C/S应用中，常用计算机集群（或服务器场）构建一个强大的虚拟服务器。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116093728_image.png)

P2P方式的最突出特性之一就是它的可扩展性。因为系统每增加一个对等方，不仅增加的是服务的请求者，同时也增加了服务的提供者，系统性能不会因规模的增大而降低。

P2P方式具有成本上的优势，因为它通常不需要庞大的服务器设施和服务器带宽。为了降低成本，服务提供商对于将P2P方式用于应用的兴趣越来越大。

## 6.3动态主机配置协议DHCP

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116102251_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116102752_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116102907_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116103013_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116103155_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116114413_image.png)

## 6.4域名系统DNS

因特网采用层次树状结构的域名结构。

域名的结构由若干个分量组成，各分量之间用“点”隔开，分别代表不同级别的域名。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116120325_image.png)

域名系统既不规定一个域名需要包含多少个下级域名，也不规定每一级的域名代表什么意思。

各级域名尤其上一级的域名管理机构管理，而最高的顶级域名则由因特网名称与数字地址分配机构ICANN进行管理。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116120802_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116121531_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116121840_image.png)

wield提高DNS的查询效率，并减轻根域名服务器的负荷和减少因特网上的DNS查询报文数量，在域名服务器中广泛地使用高速缓存。高速缓存用来存放最近查询过的域名以及从何处获得域名映射信息的记录。

由于域名到IP地址的映射关系并不是永久不变，为保持高速缓存中的内容正确，域名服务器应为每项内容设置计时器并删除超过合理时间的项（例如，每个项目只存放两天）。

不但在本地域名服务器中需要高速缓存，在用户主机中也很需要。许多用户主机在启动时从本地域名服务器下载域名和IP地址的全部数据库，维护存放自己最近使用的域名的高速缓存，并且只在从缓存中找不到域名时才向域名服务器查询。同理，主机也需要保持高速缓存中内容的正确性。

## 6.5文件传送协议FTP

将某台计算机中的文件通过网络传送到可能相距很远的另一台计算机中，是一项基本的网络应用，即文件传送。

文件传送协议FTP（File Transfer Protocol）是因特网上使用得最广泛的文件传送协议。

- FTP提供交互式的访问，允许客户指明文件的类型与格式（如指明是否使用ASCII码），并允许文件具有存取权限（如访问文件的用户必须经过授权，并输入有效的口令）。
- FTP屏蔽了各计算机系统的细节，因而适合于在异构网络中任意计算机之间传送文件。

在因特网发展的早期阶段，用FTP传送文件约占整个因特网的通信量的三分之一，而由电子邮件和域名系统所产生的通信量还要小于FTP所产生通信量。只是到了1995年，万维网WWW的通信量才首次超过FTP。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116123603_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116123822_image.png)

FTP客户和服务器之间要建立以下两个并行的TCP连接：

- 控制连接，在整个会话期间一直保持打开，用于传送FTP相关控制命令。
- 数据连接，用于文件传输，在每次文件传输时才建立，传输结束就关闭。
- 默认情况下，FTP使用TCP 21端口进行控制连接，TCP 20端口进行数据链据。但是，是否使用TCP 20端口建立数据连接与传输模式有关，主动方式使用TCP 20端口，被动方式由服务器和客户端自行协议决定。

## 6.6电子邮件

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116125457_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116125635_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116125949_image.png)

SMTP协议只能传送ASCII码文本数据，不能传送可执行文件或其他的二进制对象。

SMTP不能满足传送多媒体邮件（例如带有图片、音频或视频数据）的需要。并且许多其他非英语国家的文字（例如中文、俄文、甚至带有重音符号的法文或德文）也无法用SMTP传送。

为解决SMTP传送非ASCII码文本的问题，提出了多用途因特网邮件扩展MIME：

- 增加了5个新的邮件首部字段，这些字段提供了有关邮件主体的信息。
- 定义了许多邮件内容的格式，对多媒体电子邮件的表示方法进行了标准化。
- 定义了传送编码，可对任何内容格式进行转换，而不会被邮件系统改变。

实际上，MIME不仅仅用于SMTP，也用于后来的同样面向ASCII字符的HTTP。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116130928_image.png)

POP3和IMAP4都采用基于TCP连接的客户/服务器方式。POP3使用熟知端口110，IMAP4使用熟知端口143。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116131430_image.png)

## 6.7万维网WWW

万维网WWW（World Wild Web）并非某种特殊的计算机网络。它是一个大规模的、联机式的信息储藏所，是运行在因特网上的一个分布式应用。

万维网利用网页之间的超链接将不同网站的网页连接成一张逻辑上的信息网。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116132232_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116132426_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116134938_image.png)

HTTP/1.0采用非持续连接方式。在该方式下，每次浏览器要请求一个文件都要与服务器建立TCP连接，当收到响应后就立即关闭连接。

- 每请求一个文档就要有两倍的RTT的开销。若一个网页上有很多引用对象（例如图片等），那么请求每一个对象都需要花费2RTT的时间。
- 为了减小时延，浏览器通常会建立多个并行的TCP连接同时请求多个对象。但是，这会大量占用万维网服务器的资源，特别是万维网服务器往往要同时服务于大量客户的请求，这会使其负担很重。

HTTP/1.1采用持续连接的方式。在该方式下，万维网服务器在发送响应后仍然保持这条连接，使同一个客户（浏览器）和该服务器可以继续在这条连接上传送后续的HTTP请求报文和响应报文。这并不局限于传送同一个页面上引用的对象，而是只要这些文档都在同一个服务器上就行。

- 为了进一步提高效率，HTTP/1.1的持续连接还可以使用流水线方式工作，即浏览器在收到HTTP的响应报文之前就能够连续发送多个请求报文。这样的一个接一个的请求报文到达服务器后，服务器就发回一个接一个的响应报文。这样就节省了很多个RTT时间，使TCP连接中的空闲时间减少，提高了下载文档的效率。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116135855_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116135931_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116140005_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116140050_image.png)

使用Cookie在服务器上记录用户信息：

- 早期的万维网应用非常简单，仅仅是用户查看存放在不同服务器上的各种静态文档。因此HTTP被设计为一种无状态的协议。这样可以简化服务器的设计。
- 现在，用户可以通过万维网实现各种复杂的应用，如网上购物、电子商务等。这些应用往往需要万维网服务器能够识别用户。
- Cookie提供了一种机制使得万维网服务器能够“记住”用户，而无需用户主动提供用户标识信息。也就是说，Cookie是一种对无状态的HTTP进行状态化的技术。

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116140516_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116140608_image.png)

![](https://images.cnblogs.com/cnblogs_com/blogs/825617/galleries/2434822/o_250116140645_image.png)

若Web缓存的命中率较高，将会大大减少了该链路上的通信量，因而减少了访问因特网的时延。

# 备忘录+文件网盘

# gRPC-ToDoList 文件上传系统

本项目是基于 Go 的分布式文件上传系统，支持**表单上传 + 流式上传 + 异步处理 + 秒传功能**，采用微服务架构设计，支持通过 Kafka 进行异步任务调度，并使用七牛云作为最终的云存储目标。

## 技术栈概览

### 编程语言与框架

| 层级       | 技术            | 描述                                                 |
| ---------- | --------------- | ---------------------------------------------------- |
| Web 网关层 | Gin             | 轻量级 HTTP Web 框架，负责接收表单上传请求和用户鉴权 |
| RPC 通信   | gRPC + protobuf | 服务间通信使用 gRPC，支持流式大文件上传              |
| 微服务     | Go              | 所有微服务均使用 Go 实现，结构清晰、性能优越         |
| ORM        | GORM            | Go 语言主流 ORM 框架，简化数据库操作                 |
| 日志       | Zap             | 高性能结构化日志库，用于记录请求、错误与链路追踪     |

---

### 存储与中间件

| 组件                | 功能     | 说明                                       |
| ------------------- | -------- | ------------------------------------------ |
| **MySQL**           | 数据库   | 存储用户信息、文件元数据、上传记录等       |
| **Redis**           | 缓存服务 | 用于临时缓存或实现秒传快速查重逻辑         |
| **Kafka**           | 消息队列 | 异步上传任务投递、延时任务处理（支持重试） |
| **etcd**            | 注册中心 | 支持 gRPC 服务注册与发现，服务自治         |
| **本地目录/七牛云** | 对象存储 | 文件最终存储位置（目前采用七牛云）         |

> 支持将文件从临时目录写入本地目录或上传至七牛云进行云存储。



---

## 支持的上传方式

- ✅ 表单上传（适用于小文件，支持秒传机制）
- ✅ 分片流式上传（适用于大文件）
- ✅ 异步上传（通过 Kafka 解耦处理逻辑，提升响应性能）
- ✅ 秒传（根据 hash 判断文件是否存在）

---

## Docker 支持

项目支持通过 Docker 一键部署以下服务：

- etcd
- Redis
- Kafka（含 Zookeeper）
- MySQL

使用方式：

```bash
// 启动
docker-compose up -d
// 关闭
docker-compose down
```